---
title: "A2 - Análisis estadístico I"
author: "Fernando Antonio Barbeiro Campos - fbarbeiro@uoc.edu"

date: '`r format(Sys.Date(),"%e de %B, %Y")`'
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
---
 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_libraries, include=FALSE}
library(knitr)
```
# Introducción

<div style="text-align: justify">
En esta actividad usaremos el fichero de **World Happiness Report** “limpio”, es decir, después del preproceso que se ha realizado. Una vez el fichero está preparado, pasaremos a realizar análisis propios de la estadística descriptiva e inferencial. Os proporcionamos el fichero **2016_clean.csv** para que todos trabajéis con el mismo fichero de datos, independientemente del resultado obtenido en la actividad 1.
Recordamos que el fichero de datos recoge información sobre el grado de felicidad de países del mundo. El archivo contiene 157 registros y 13 variables. Estas variables son: *Country, Region, HR, HS, LCI, UCI, GpC, Family, LE, Freedom, GC, Generosity, DR donde HR: Happiness Rank, HS: Happiness Score, LCI y UCI*:
*Lower y Upper Confidence Interval, GpC: GDP per Capita, LE: Life Expectancy, GC: Trust Government Corruption, DR: Dystopia.*
Recordar que **no** se pueden realizar listados completos de los datos en la solución. El motivo es que se generan ficheros de salida con centenares de páginas que son muy difícil de trazar y corregir. Para comprobar las funcionalidades del código, podéis usar **head** y **tail** que solo muestran unas líneas del fichero.
</div>

```{r chunck1}
# Loading the dataframe
df <- read.csv("../2016_clean.csv")
head(df)
```

# 1. Estadística Descriptiva
<div style="text-align: justify">
*A continuación, se estudiarán algunos valores centrales y de dispersión de algunas variables del fichero. Realizar los pasos que se indican a continuación.*
</div>

## 1.1 Valores centrales de HS (*Happiness Score*)
<p style="text-align: justify">
Calcular la media, mediana y el sumario de cinco números (de Tukey) del valor HS Happiness Score de toda la muestra. A continuación, visualizar la distribución de este valor en un diagrama de caja (boxplot) e interpretar el resultado. Finalmente, visualizar otro diagrama de caja donde se muestre el valor de HS para cada región. Es decir, en el mismo gráfico debe haber una caja para cada región representada en el fichero. Interpretar los gráficos.
</p>
### Respuesta
```{r chunck2}
N <- length(df$HS)
# Media de Happiness Score
mean(df$HS) # Using function
sum(df$HS)/N # Manually calculating

#Mediana
median(df$HS)
HS_sorted <- sort(df$HS)

if((N %% 2) == 0) {
  print(paste("Mi mediana calculada es", (HS_sorted[floor((N+1)/2)] + HS_sorted[ceiling((N+1)/2)]) / 2))
} else {
  print(paste("Mi mediana calculada es", HS_sorted[(N+1)/2]))
}

# five numbers (Tukey)
summary(fivenum(df$HS))

# One by one - manually
min(df$HS)
quantile(df$HS, 0.25) # Mediana del "bottom half"
median(df$HS)
quantile(df$HS, 0.75) # Mediana del "top half"
max(df$HS)

boxplot(df$HS)
```

<p style="text-align: justify">
La interpretación del gráfico de caja sobre la distribución de los valores de *Happiness Score* es bastante sencilla. En la parte más inferior del gráfico tenemos la línea del **valor mínimo** (2.905, según hemos extraído en  el sumario de cinco números). Entonces el dibujo de la caja en sí empieza en el **primer cuartil Q1** - 4.404 - que representa 25%, o sea, la mediana del *bottom half* de nuestra muestra. La próxima línea que tenemos trazada más en negrita es **la mediana - 5.314**, y en la parte superior de la caja, el **cuartil Q3 75%** - 6.269 -> mediana del *top half* de la muestra. Finalmente, la última línea superior arriba de la caja llega hasta al **valor máximo** de la muestra que es 7.526.
</p>

```{r chunck3}
summary(df$Region)

# Grafico para cada región representada
boxplot(df$HS ~ df$Region, main="Happiness Score by Region", ylab="Happiness Score", las=2)
```

